---
layout: post
title: å®ç°Instagramçš„Material Designæ¦‚å¿µè®¾è®¡
tags: [android, material design, ui, animations, layout]
---

å‡ ä¸ªæœˆå‰ï¼ˆè¿™ç¯‡æ–‡ç« çš„æ—¥æœŸæ˜¯2014 å¹´11æœˆ10æ—¥ï¼‰ï¼Œgoogleå‘å¸ƒäº†appå’Œwebåº”ç”¨çš„Material Designè®¾è®¡å‡†åˆ™ä¹‹åï¼Œè®¾è®¡å¸ˆEmmanuel Pacamalanåœ¨youtubeä¸Šå‘å¸ƒäº†ä¸€åˆ™æ¦‚å¿µè§†é¢‘ï¼Œæ¼”ç¤ºäº†Instagramå¦‚æœåšæˆMaterialé£æ ¼ä¼šæ˜¯ä»€ä¹ˆæ ·å­ï¼š

<!-- more -->

<iframe width="560" height="315" src="//www.youtube.com/embed/ojwdmgmdR_Q" frameborder="0" allowfullscreen></iframe>

è¿™ä»…ä»…æ˜¯åœç•™åœ¨å›¾åƒä¸Šçš„è®¾è®¡ï¼Œæ˜¯ç¾å¥½çš„æ„¿æ™¯ï¼Œä¼°è®¡å¾ˆå¤šäººéƒ½ä¼šé—®ï¼Œèƒ½å¦ä½¿ç”¨ç›¸å¯¹ç®€å•çš„åŠæ³•å°†å®ƒå®ç°å‡ºæ¥å‘¢ï¼Ÿç­”æ¡ˆæ˜¯ï¼šyesï¼Œä¸ä»…ä»…èƒ½å®ç°ï¼Œè€Œä¸”æ— é¡»è¦æ±‚åœ¨ Lillipopç‰ˆæœ¬ï¼Œå®é™…ä¸Šå‡ å¹´å‰4.0å‘å¸ƒä¹‹åæˆ‘ä»¬å°±å¯ä»¥å®ç°è¿™äº›æ•ˆæœäº†ã€‚ps è¯»åˆ°è¿™é‡Œæˆ‘ä»¬åº”è¯¥åæ€è¿™å‡ å¹´å¼€å‘è€…æ˜¯ä¸æ˜¯éƒ½åƒå±å»äº†ã€‚

é‰´äºè¿™ä¸ªåŸå› ï¼Œæˆ‘å†³å®šå¼€å§‹æ’°å†™ä¸€ä¸ªæ–°çš„è¯¾é¢˜-å¦‚ä½•å°† *[INSTAGRAM with Material Design]* è§†é¢‘ä¸­çš„æ•ˆæœè½¬å˜æˆç°å®ã€‚å½“ç„¶ï¼Œæˆ‘ä»¬å¹¶ä¸æ˜¯çœŸçš„è¦åšä¸€ä¸ªInstagramåº”ç”¨ï¼Œåªæ˜¯å°†ç•Œé¢åšå‡ºæ¥è€Œå·²ï¼Œå¹¶ä¸”å°½é‡å‡å°‘ä¸€äº›ä¸å¿…è¦çš„ç»†èŠ‚ã€‚

#å¼€å§‹
æœ¬æ–‡å°†è¦å®ç°çš„æ˜¯è§†é¢‘ä¸­å‰7ç§’é’Ÿçš„æ•ˆæœã€‚æˆ‘è§‰å¾—å¯¹äºç¬¬ä¸€æ¬¡å°è¯•æ¥è¯´å·²ç»è¶³å¤Ÿäº†ã€‚æˆ‘æƒ³è¦æé†’è¯¸ä½çš„æ˜¯ï¼Œé‡Œé¢çš„å®ç°æ–¹æ³•ä¸ä»…ä»…æ˜¯èƒ½å®ç°ï¼Œä¹Ÿæ˜¯æˆ‘ä¸ªäººæœ€å–œæ¬¢çš„å®ç°æ–¹å¼ã€‚è¿˜æœ‰ï¼Œæˆ‘ä¸æ˜¯ä¸€ä¸ªç¾å·¥ï¼Œå› æ­¤é¡¹ç›®ä¸­çš„æ‰€æœ‰å›¾ç‰‡æ˜¯ç›´æ¥ä»ç½‘ä¸Šå…¬å¼€çš„æ¸ é“è·å–çš„ã€‚ï¼ˆä¸»è¦æ˜¯ä»[resources page]).

å¥½äº†ï¼Œä¸‹é¢æ˜¯æœ€ç»ˆæ•ˆæœçš„ä¸¤ç»„æˆªå›¾å’Œè§†é¢‘ï¼ˆå¾ˆçŸ­çš„è§†é¢‘ï¼Œå°±æ˜¯é‚£7ç§’é’Ÿçš„æ•ˆæœï¼Œå¯ä»¥åœ¨ä¸Šé¢çš„è§†é¢‘ä¸­çœ‹åˆ°ï¼Œè¿™é‡Œå› ä¸ºæ²¡æ³•ç›´æ¥å¼•ç”¨youtubeçš„è§†é¢‘å°±ç•¥äº†ï¼‰ï¼ˆåˆ†åˆ«ä»Android 4 å’Œ5ä¸Šè·å¾—çš„ï¼‰ï¼š

![Android Lollipop screenshot](/images/2/screen-21.png "Android Lollipop screenshot")
![Android pre-21 screenshot](/images/2/screen-pre21.png "Android pre-21 screenshot")

<iframe width="420" height="315" src="//www.youtube.com/embed/rTucTiIlQDA" frameborder="0" allowfullscreen></iframe>

<iframe width="420" height="315" src="//www.youtube.com/embed/fYhpc1LddHE" frameborder="0" allowfullscreen></iframe>

# å‡†å¤‡
åœ¨æˆ‘ä»¬çš„é¡¹ç›®ä¸­ï¼Œå°†ä½¿ç”¨ä¸€äº›çƒ­é—¨çš„androidå¼€å‘å·¥å…·å’Œåº“ã€‚å¹¶ä¸æ˜¯æ‰€æœ‰è¿™äº›ä¸œè¥¿æœ¬ç¯‡æ–‡ç« éƒ½ä¼šç”¨åˆ°ï¼Œæˆ‘åªæ˜¯å°†å®ƒä»¬å‡†å¤‡å¥½ä»¥å¤‡ä¸æ—¶ä¹‹éœ€ã€‚

## åˆå§‹åŒ–é¡¹ç›®
é¦–å…ˆæˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ªæ–°çš„androidé¡¹ç›®ã€‚æˆ‘ä½¿ç”¨çš„æ˜¯Android Studioå’Œgradleçš„buildæ–¹å¼ã€‚æœ€ä½ç‰ˆæœ¬çš„sdkæ˜¯15ï¼ˆå³Android 4.0.4ï¼‰ã€‚

ç„¶åæˆ‘ä»¬å°†æ·»åŠ ä¸€äº›ä¾èµ–ã€‚æ²¡ä»€ä¹ˆå¥½è®²çš„ï¼Œä¸‹é¢æ˜¯build.gradleä»¥åŠapp/build.gradleæ–‡ä»¶çš„ä»£ç ï¼š

{% gist frogermcs/61b885eb2e44e0d2d61f build.gradle %}

{% gist frogermcs/61b885eb2e44e0d2d61f appbuild.gradle %}

ç®€è€Œè¨€ä¹‹ï¼Œæˆ‘ä»¬æœ‰å¦‚ä¸‹å·¥å…·ï¼š

* ä¸€äº›å…¼å®¹åŒ…ï¼ˆCardView, RecyclerView, Palette, AppCompatï¼‰-æˆ‘å–œæ¬¢ä½¿ç”¨æœ€æ–°çš„æ§ä»¶ã€‚å½“ç„¶ä½ å®Œå…¨å¯ä»¥ä½¿ç”¨ListView Actionbarç”šè‡³View/FrameViewæ¥æ›¿ä»£ï¼Œä½†æ˜¯ä¸ºä»€ä¹ˆè¦è¿™ä¹ˆæŠ˜è…¾ï¼Ÿ ğŸ˜‰
* [ButterKnife] - viewæ³¨å…¥å·¥å…·ç®€åŒ–æˆ‘ä»¬çš„ä»£ç ã€‚ï¼ˆæ¯”æ–¹è¯´ä¸å†éœ€è¦å†™findViewById()æ¥å¼•ç”¨viewï¼Œä»¥åŠä¸€äº›æ›´å¼ºå¤§çš„åŠŸèƒ½ï¼‰.
* [Rebound] - æˆ‘ä»¬ç›®å‰è¿˜æ²¡æœ‰ç”¨åˆ°ï¼Œä½†æ˜¯æˆ‘ä»¥åè‚¯å®šä¼šç”¨å®ƒã€‚è¿™ä¸ªfacebookå¼€å‘çš„åŠ¨ç”»åº“å¯ä»¥è®©ä½ çš„åŠ¨ç”»æ•ˆæœçœ‹èµ·æ¥æ›´è‡ªç„¶ã€‚
* [Timber] and [Hugo] - å¯¹è¿™ä¸ªé¡¹ç›®è€Œè¨€å¹¶ä¸æ˜¯å¿…é¡»ï¼Œæˆ‘ä»…ä»…æ˜¯ç”¨ä»–ä»¬æ‰“å°logã€‚

### å›¾ç‰‡èµ„æº
æœ¬é¡¹ç›®ä¸­å°†ä½¿ç”¨åˆ°ä¸€äº›Material Designçš„å›¾æ ‡èµ„æºã€‚App å›¾æ ‡æ¥è‡ªäº[INSTAGRAM with Material Design] è§†é¢‘ï¼Œè¿™é‡Œ [complete bunch of images] æ˜¯é¡¹ç›®çš„å…¨å¥—èµ„æº.

### v
æˆ‘ä»¬ä»å®šä¹‰appçš„é»˜è®¤æ ·å¼å¼€å§‹ã€‚åŒæ—¶ä¸ºAndroid 4å’Œ5å®šä¹‰Material Desingæ ·å¼çš„æœ€ç®€å•çš„æ–¹å¼æ˜¯ç›´æ¥ç»§æ‰¿Theme.AppCompat.NoActionBar æˆ–è€… Theme.AppCompat.Light.NoActionBarä¸»é¢˜ã€‚ä¸ºä»€ä¹ˆæ˜¯NoActionBarï¼Ÿå› ä¸ºæ–°çš„sdkä¸­ä¸ºæˆ‘ä»¬æä¾›äº†å®ç°ActionbaråŠŸèƒ½çš„æ–°æ¨¡å¼ã€‚æœ¬ä¾‹ä¸­æˆ‘ä»¬å°†ä½¿ç”¨Toolbaræ§ä»¶ï¼ŒåŸºäºè¿™ä¸ªåŸå› -Toolbaræ˜¯ActionBaræ›´å¥½æ›´çµæ´»çš„è§£å†³æ–¹æ¡ˆã€‚æˆ‘ä»¬ä¸ä¼šæ·±å…¥è®²è§£è¿™ä¸ªé—®é¢˜ï¼Œä½†ä½ å¯ä»¥å»é˜…è¯»androidå¼€å‘è€…åšå®¢ [AppCompat v21].

æ ¹æ®æ¦‚å¿µè§†é¢‘ä¸­çš„æ•ˆæœï¼Œæˆ‘ä»¬åœ¨AppThemeä¸­å®šä¹‰äº†ä¸‰ä¸ªåŸºæœ¬é¢œè‰² `AppTheme`:

{% gist frogermcs/61b885eb2e44e0d2d61f styles.xml %}

{% gist frogermcs/61b885eb2e44e0d2d61f colors1.xml %}

å…³äºè¿™ä¸‰ä¸ªé¢œè‰²çš„æ„ä¹‰ï¼Œä½ å¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ°[Material Theme Color Palette documentation].

###å¸ƒå±€
é¡¹ç›®ç›®å‰ä¸»è¦ä½¿ç”¨äº†3ä¸ªä¸»è¦çš„å¸ƒå±€å…ƒç´ :

* **Toolbar** - åŒ…å«å¯¼èˆªå›¾æ ‡å’Œapplogoçš„é¡¶éƒ¨bar
* **RecyclerView** - ç”¨äºæ˜¾ç¤ºfeed
* **Floating Action Button** - ä¸€ä¸ªå®ç°äº†Material Designä¸­ [action button pattern] çš„ImageButton.

åœ¨å¼€å§‹å®ç°å¸ƒå±€ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆåœ¨ `res/values/dimens.xml`æ–‡ä»¶ä¸­å®šä¹‰ä¸€äº›é»˜è®¤å€¼:

{% gist frogermcs/61b885eb2e44e0d2d61f dimens.xml %}

è¿™äº›å€¼çš„å¤§å°æ˜¯åŸºäºMaterial Designè®¾è®¡å‡†åˆ™ä¸­çš„ä»‹ç»ã€‚

ç°åœ¨æˆ‘ä»¬æ¥å®ç°`MainActivity`ä¸­çš„layout:

{% gist frogermcs/61b885eb2e44e0d2d61f activity_main.xml %}

ä»¥ä¸Šä»£ç çš„è§£é‡Š:

* å…³äº`Toolbar` é‡è¦çš„ç‰¹å¾æ˜¯ä»–ç°åœ¨æ˜¯activity layoutçš„ä¸€éƒ¨åˆ†ï¼Œè€Œä¸”ç»§æ‰¿è‡ªViewGroupï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥åœ¨é‡Œé¢æ”¾ä¸€äº›UIå…ƒç´ ï¼ˆå®ƒä»¬å°†åˆ©ç”¨å‰©ä½™ç©ºé—´ï¼‰ã€‚æœ¬ä¾‹ä¸­ï¼Œå®ƒè¢«ç”¨æ¥æ”¾ç½®logoå›¾ç‰‡ã€‚åŒæ—¶ï¼Œå› ä¸ºToolbaræ˜¯æ¯”Actionbaræ›´çµæ´»çš„æ§ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥è‡ªå®šä¹‰æ›´å¤šçš„ä¸œè¥¿ï¼Œæ¯”å¦‚è®¾ç½®èƒŒæ™¯é¢œè‰²ä¸ºcolorPrimaryï¼ˆå¦åˆ™`Toolbar`å°†æ˜¯é€æ˜çš„ï¼‰ã€‚
* `RecyclerView` è™½ç„¶åœ¨xmlä¸­ç”¨èµ·æ¥éå¸¸ç®€å•ï¼Œä½†æ˜¯å¦‚æœjavaä»£ç ä¸­æ²¡æœ‰è®¾ç½®æ­£ç¡®ï¼Œappæ˜¯ä¸èƒ½å¯åŠ¨çš„ï¼Œä¼šæŠ¥`java.lang.NullPointerException` (it's connected with not configured LayoutAdapter which is resposible for arranging items inside RecyclerView).
* Elevation å±æ€§ä¸å…¼å®¹API 21ä»¥å‰çš„ç‰ˆæœ¬ã€‚æ‰€ä»¥å¦‚æœæˆ‘ä»¬æƒ³åšåˆ° **Floating Action Button** çš„æ•ˆæœéœ€è¦åœ¨Lollipopå’ŒLollipopä¹‹å‰çš„è®¾å¤‡ä¸Šä½¿ç”¨ä¸åŒçš„`background`.

#### Floating Action Button
ä¸ºäº†ç®€åŒ–FABçš„ä½¿ç”¨ï¼Œæˆ‘ä»¬å°†ç”¨å¯¹Lollipopä»¥åŠLollipopä¹‹å‰çš„è®¾å¤‡ä½¿ç”¨ä¸åŒçš„æ ·å¼ï¼š

 * **FAB for Android v21**:

 ![FAB Android 21](/images/2/fab-21.png "FAB Android 21")

 * **FAB for Android pre-21**

 ![FAB Android pre-21](/images/2/fab-pre21.png "FAB Android pre-21")

 æˆ‘ä»¬éœ€è¦åˆ›å»ºä¸¤ä¸ªä¸åŒçš„xmlæ–‡ä»¶æ¥è®¾ç½®buttonçš„background:
  `/res/drawable-v21/btn_fab_default.xml` ä¸ºAndroid Lollipopç‰ˆæœ¬è®¾å¤‡å’Œ `/res/drawable/btn_fab_default.xml` ä¸ºLollipopä¹‹å‰çš„ç‰ˆæœ¬:

{% gist frogermcs/61b885eb2e44e0d2d61f btn_fab_default2.xml %}

{% gist frogermcs/61b885eb2e44e0d2d61f btn_fab_default1.xml %}

æˆ‘ä»¬è¿˜è¦åœ¨ `res/values/colors.xml` æ–‡ä»¶ä¸­æ·»åŠ ä¸¤ä¸ªé¢œè‰²:
{% highlight xml %}
<color name="btn_default_light_normal">#00000000</color>
<color name="btn_default_light_pressed">#40ffffff</color>
{% endhighlight %}

å¯ä»¥çœ‹åˆ°åœ¨ 21ä¹‹å‰çš„è®¾å¤‡å•†åˆ¶é€ é˜´å½±æ¯”è¾ƒå¤æ‚ã€‚ä¸å¹¸çš„æ˜¯åœ¨xmlä¸­è¾¾åˆ°çœŸå®çš„é˜´å½±æ•ˆæœæ²¡æœ‰æ¸å˜æ–¹æ³•ã€‚å…¶ä»–çš„åŠæ³•æ˜¯ä½¿ç”¨å›¾ç‰‡çš„æ–¹å¼ï¼Œæˆ–è€…é€šè¿‡javaä»£ç å®ç° (å‚è§ [creating fab shadow]).

#### Toolbar
ç°åœ¨æˆ‘ä»¬æ¥å®Œæˆ`Toolbar`ã€‚æˆ‘ä»¬å·²ç»æœ‰äº†backgroundå’Œåº”ç”¨çš„logoï¼Œç°åœ¨è¿˜å‰©ä¸‹navigationä»¥åŠmenuèœå•å›¾æ ‡äº†ã€‚.

éå¸¸ä¸å¹¸çš„æ˜¯ï¼Œåœ¨xmlä¸­`app:navigationIcon=""` æ˜¯ä¸èµ·ä½œç”¨çš„ï¼Œè€Œ`android:navigationIcon=""` åˆåªèƒ½åœ¨Lollipopä¸Šæœ‰ç”¨ï¼Œæ‰€ä»¥åªèƒ½ä½¿ç”¨ä»£ç çš„æ–¹å¼äº†:

{% highlight java %}
toolbar.setNavigationIcon(R.drawable.ic_menu_white);
{% endhighlight %}

è‡³äºmenuå›¾æ ‡æˆ‘ä»¬ä½¿ç”¨æ ‡å‡†çš„å®šä¹‰æ–¹å¼å°±å¥½äº† `res/menu/menu_main.xml`:

{% gist frogermcs/61b885eb2e44e0d2d61f menu_main.xml %}

åœ¨activityä¸­inflatedè¿™ä¸ªmenu:
{% highlight java %}
@Override
public boolean onCreateOptionsMenu(Menu menu) {
    getMenuInflater().inflate(R.menu.menu_main, menu);
    return true;
}
{% endhighlight %}

æœ¬åº”è¿è¡Œçš„å¾ˆå¥½ï¼Œä½†æ˜¯æ­£å¦‚æˆ‘åœ¨twitterä¸Šæåˆ°çš„ï¼ŒToolbar onClick  selectorsæœ‰ä¸åè°ƒçš„æƒ…å†µ:

 <iframe width="560" height="510" src="//twitframe.com/show?url=https://twitter.com/froger_mcs/status/530995707080359936" frameborder="0" allowfullscreen></iframe>

ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œéœ€è¦åšæ›´å¤šçš„å·¥ä½œï¼Œé¦–å…ˆä¸ºmenu itemåˆ›å»ºä¸€ä¸ªè‡ªå®šä¹‰çš„view (`res/layout/menu_item_view.xml`):

{% gist frogermcs/61b885eb2e44e0d2d61f menu_item_view.xml %}

ç„¶åä¸ºLollipopå’ŒLollipopä¹‹å‰çš„è®¾å¤‡åˆ†åˆ«åˆ›å»ºonClickçš„selectorï¼Œåœ¨Lollipopä¸Šæœ‰rippleæ•ˆæœ:

{% gist frogermcs/61b885eb2e44e0d2d61f btn_default_light2.xml %}

{% gist frogermcs/61b885eb2e44e0d2d61f btn_default_light1.xml %}

ç°åœ¨ï¼Œå·¥ç¨‹ä¸­çš„æ‰€æœ‰çš„coloråº”è¯¥æ˜¯è¿™æ ·å­äº†:

{% gist frogermcs/61b885eb2e44e0d2d61f colors.xml %}

æœ€åæˆ‘ä»¬åº”è¯¥å°†custom viewæ”¾åˆ°menu itemä¸­ï¼Œåœ¨`onCreateOptionsMenu()`ä¸­:

{% highlight java %}
@Override
public boolean onCreateOptionsMenu(Menu menu) {
    getMenuInflater().inflate(R.menu.menu_main, menu);
    inboxMenuItem = menu.findItem(R.id.action_inbox);
    inboxMenuItem.setActionView(R.layout.menu_item_view);
    return true;
}
{% endhighlight %}

ä»¥ä¸Šå°±æ˜¯toolbarçš„æ‰€æœ‰ä¸œè¥¿ã€‚å¹¶ä¸”onClickçš„æŒ‰ä¸‹æ•ˆæœä¹Ÿè¾¾åˆ°äº†é¢„æœŸçš„æ•ˆæœ:

![Toolbar menu item onClick](/images/2/toolbar.png "Toolbar menu item onClick")


#### Feed
Last thing we should implement is feed, built on `RecyclerView`. Right now we have to setup two things: layout manager (RecyclerView has to know how to arrange items) and adapter (to provide items).
æœ€åæˆ‘ä»¬è¦å®ç°çš„æ˜¯feedï¼ŒåŸºäº`RecycleView`.ç°åœ¨æˆ‘ä»¬è¦è®¾ç½®ä¸¤ä¸ªä¸œè¥¿ï¼šlayout manager å’Œ adapterã€‚

ç¬¬ä¸€ä»¶äº‹æ¯”è¾ƒç®€å•ï¼å®ç°ä¸€ä¸ªç®€å•çš„ListViewæ•ˆæœï¼Œå°±ç”¨`LinearLayoutManager`å°±å¯ä»¥äº†ã€‚ç„¶åè¦åšäº›ä¸èƒ½å·æ‡’çš„code.

æˆ‘ä»¬å…ˆä»Itemçš„å¸ƒå±€å¼€å§‹ (`res/layout/item_feed.xml`):

{% gist frogermcs/61b885eb2e44e0d2d61f item_feed.xml %}

åœ¨ä¸Šé¢çš„ä»£ç ä¸­:

* `CardView` - ç»™åˆ—è¡¨é¡¹è¾¹æ·»åŠ åœ†è§’è¾¹å’Œé˜´å½± (æ”¯æŒ Android 21 and pre-21).
* `ImageViews` åˆ—è¡¨é¡¹æ˜¾ç¤ºå›¾ç‰‡ (SquaredImageView ç”¨æ¥æ˜¾ç¤ºåœ†å½¢å›¾ç‰‡).

åŒæ ·`FeedAdapter` ä¹Ÿæ¯”è¾ƒç®€å•:
{% gist frogermcs/61b885eb2e44e0d2d61f FeedAdapter.java %}

æ²¡å•¥ç‰¹æ®Šè¦è®²çš„.

æŠŠæ‰€æœ‰çš„ä»£ç åˆåˆ°ä¸€èµ·ï¼Œç„¶ååœ¨ `MainActivity` ç±»ä¸­æ·»åŠ å¦‚ä¸‹æ–¹æ³•:
{% highlight java %}
private void setupFeed() {
    LinearLayoutManager linearLayoutManager = new LinearLayoutManager(this);
    rvFeed.setLayoutManager(linearLayoutManager);
    feedAdapter = new FeedAdapter(this);
    rvFeed.setAdapter(feedAdapter);
}
{% endhighlight %}

ä¸‹é¢æ˜¯å®Œæ•´çš„ MainActivity ä»£ç :
{% gist frogermcs/61b885eb2e44e0d2d61f MainActivity1.java %}

ä¸ºäº†é¿å…é—æ¼ï¼Œè¿™é‡Œæ˜¯åˆ°ç›®å‰ä¸ºæ­¢çš„æ‰€æœ‰ä»£ç  [commit for whole project].

è¿™é‡Œçš„è¿è¡Œç»“æœ:

* **Android Lollipop**

![Android Lollipop screenshot](/images/2/screen-21.png "Android Lollipop screenshot")

* **Android pre-21**

![Android pre-21 screenshot](/images/2/screen-pre21.png "Android pre-21 screenshot")

### Animations

æœ€åä¸€ä»¶ä¹Ÿæ˜¯æœ€é‡è¦çš„äº‹æƒ…å°±æ˜¯è¿›å…¥æ—¶çš„åŠ¨ç”»æ•ˆæœï¼Œå†æµè§ˆä¸€éæ¦‚å¿µè§†é¢‘ï¼Œå¯ä»¥å‘ç°åœ¨main Activityå¯åŠ¨çš„æ—¶å€™æœ‰å¦‚ä¸‹åŠ¨ç”»ï¼Œåˆ†æˆä¸¤æ­¥:

* æ˜¾ç¤ºToolbarä»¥åŠå…¶é‡Œé¢çš„å…ƒç´ 
* åœ¨ToolbaråŠ¨ç”»å®Œæˆä¹‹åæ˜¾ç¤ºfeedå’Œfloating action button.

Toolbar ä¸­å…ƒç´ çš„åŠ¨ç”»è¡¨ç°ä¸ºåœ¨è¾ƒçŸ­çš„æ—¶é—´å†…ä¸€ä¸ªæ¥ä¸€ä¸ªçš„è¿›å…¥ã€‚å®ç°è¿™ä¸ªæ•ˆæœçš„ä¸»è¦é—®é¢˜åœ¨äºnavigation iconçš„åŠ¨ç”»ï¼Œnavigation iconæ˜¯å”¯ä¸€ä¸€ä¸ªä¸èƒ½ä½¿ç”¨åŠ¨ç”»çš„ï¼Œå…¶ä»–çš„éƒ½å¥½åŠ.

#### Toolbar animation
é¦–å…ˆæˆ‘ä»¬åªæ˜¯éœ€è¦åœ¨activityå¯åŠ¨çš„æ—¶å€™æ‰æ’­æ”¾åŠ¨ç”»ï¼ˆåœ¨æ—‹è½¬å±å¹•çš„æ—¶å€™ä¸æ’­æ”¾ï¼‰. è¿˜è¦çŸ¥é“menuçš„åŠ¨ç”»è¿‡ç¨‹æ˜¯ä¸èƒ½åœ¨`onCreate()``ä¸­å»å®ç°çš„ (æˆ‘ä»¬åœ¨ `onCreateOptionsMenu()`ä¸­å®ç°).

åˆ›å»ºä¸€ä¸ªå¸ƒå°”ç±»å‹çš„å˜é‡ `pendingIntroAnimation` åœ¨ `MainActivity`ä¸­. åœ¨`onCreate()` æ–¹æ³•ä¸­åˆå§‹åŒ–:
{% highlight java %}
//...
if (savedInstanceState == null) {
    pendingIntroAnimation = true;
}
{% endhighlight %}

å¹¶åœ¨ `onCreateOptionsMenu()`æ–¹æ³•ä¸­ä½¿ç”¨:
{% highlight java %}
@Override
public boolean onCreateOptionsMenu(Menu menu) {
    getMenuInflater().inflate(R.menu.menu_main, menu);
    inboxMenuItem = menu.findItem(R.id.action_inbox);
    inboxMenuItem.setActionView(R.layout.menu_item_view);
    if (pendingIntroAnimation) {
        pendingIntroAnimation = false;
        startIntroAnimation();
    }
    return true;
}
{% endhighlight %}

è¿™æ ·å½“æˆ‘ä»¬è¿è¡Œæˆ‘ä»¬çš„åº”ç”¨æ—¶ï¼Œ`startIntroAnimation()` åªä¼šè¢«è°ƒç”¨ä¸€æ¬¡.

ç°åœ¨å‡†å¤‡Toolbarä¸­çš„å„å…ƒç´ åŠ¨ç”»äº†ã€‚ä¹ŸåŒæ ·ç®€å•ã€‚è¦è®°ä½çš„æ˜¯ï¼Œä¸€èˆ¬æ¥è¯´ï¼ŒåŠ¨ç”»æ˜¯ç”±ä¸¤ä¸ªæ­¥éª¤ç»„æˆï¼š

* preparationå‡†å¤‡ - è®¾ç½®åŠ¨ç”»å…ƒç´ çš„åˆå§‹çŠ¶æ€. å¦‚æœæˆ‘ä»¬è¦å±•ç¤ºåŠ¨ç”»ï¼Œé¦–å…ˆç¡®ä¿ä»–ä»¬å…ˆæ˜¯éšè—çš„.
* animationåŠ¨ç”» - è¿™ä¸€æ­¥æ˜¯è®¾ç½®Viewçš„æœ€åçŠ¶æ€æˆ–ä½ç½®.

ç°åœ¨æ¥å®ç°ToolbaråŠ¨ç”»çš„ä¸¤ä¸ªæ­¥éª¤:

{% gist frogermcs/61b885eb2e44e0d2d61f ToolbarAnimation %}

åœ¨ä¸Šé¢çš„ä»£ç ä¸­:

* é¦–å…ˆæˆ‘ä»¬å°†æ‰€æœ‰çš„å…ƒç´ éƒ½é€šè¿‡ç§»åŠ¨åˆ°å±å¹•ä¹‹å¤–éšè—èµ·æ¥ï¼ˆè¿™ä¸€æ­¥æˆ‘ä»¬å°†FABä¹Ÿéšè—äº†ï¼‰ã€‚
* è®©Toolbarå…ƒç´ ä¸€ä¸ªæ¥ä¸€ä¸ªçš„å¼€å§‹åŠ¨ç”»
* å½“åŠ¨ç”»å®Œæˆï¼Œè°ƒç”¨äº†startContentAnimation()å¼€å§‹contentçš„åŠ¨ç”»ï¼ˆFABå’Œfeedå¡ç‰‡çš„åŠ¨ç”»ï¼‰

ç®€å•, æ˜¯å§?

#### Content åŠ¨ç”»
åœ¨è¿™ä¸€æ­¥ä¸­æˆ‘ä»¬å°†è®©FABå’Œfeedå¡ç‰‡åŠ¨èµ·æ¥ã€‚

FABçš„åŠ¨ç”»å¾ˆç®€å•ï¼Œè·Ÿä¸Šé¢çš„æ–¹æ³•ç±»ä¼¼ï¼Œä½†æ˜¯feedå¡ç‰‡ç¨å¾®å¤æ‚äº›ã€‚

* `startContentAnimation()` æ–¹æ³•:

{% gist frogermcs/61b885eb2e44e0d2d61f FABAnimation %}

* `FeedAdapter` åŒ…å«åŠ¨ç”»å’Œfeedé¡¹

{% gist frogermcs/61b885eb2e44e0d2d61f FeedAdapter.java %}

æœ¬ç¯‡æ–‡ç« å°±ç»“æŸäº†.

ä¸ºäº†é¿å…é—æ¼, è¿™é‡Œæ˜¯ä»£ç  [commit for our project with implemented animations].

##Source code
å®Œæ•´çš„ä»£ç åœ¨Github [repository].

è‹±æ–‡åŸæ–‡ï¼š[Instagram with Material Design concept is getting real]

ä¸­æ–‡ç¿»è¯‘å‡ºå¤„ï¼šï¼»http://jcodecraeer.com/a/anzhuokaifa/androidkaifa/2015/0204/2415.htmlï¼½

*Author: [Miroslaw Stanek]*

[INSTAGRAM with Material Design]:https://www.youtube.com/watch?v=ojwdmgmdR_Q
[resources page]:http://www.google.com/design/spec/resources/sticker-sheets-icons.html
[Butterknife]:http://jakewharton.github.io/butterknife/
[Rebound]:http://facebook.github.io/rebound/
[Timber]:https://github.com/JakeWharton/timber
[Hugo]:https://github.com/JakeWharton/hugo
[complete bunch of images]:https://github.com/frogermcs/frogermcs.github.io/raw/master/files/2/resources.zip
[AppCompat v21]:http://android-developers.blogspot.com/2014/10/appcompat-v21-material-design-for-pre.html
[Material Theme Color Palette documentation]:http://developer.android.com/training/material/theme.html#ColorPalette
[action button pattern]:http://www.google.com/design/spec/components/buttons.html#buttons-flat-raised-buttons
[creating fab shadow]:http://stackoverflow.com/questions/24480425/android-l-fab-button-shadow
[commit for whole project]:https://github.com/frogermcs/InstaMaterial/commit/1095d5f199ceb5c04bb2433c8865dcea2cba6f2e
[commit for our project with implemented animations]:https://github.com/frogermcs/InstaMaterial/commit/4e838861c5f858711b1072777cae2325ce12ee21
[repository]:https://github.com/frogermcs/InstaMaterial
[Miroslaw Stanek]:http://about.me/froger_mcs
[Instagram with Material Design concept is getting real]:http://frogermcs.github.io/Instagram-with-Material-Design-concept-is-getting-real
